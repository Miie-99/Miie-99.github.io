<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>åŒäººå¥³è·³å‘æ¨¡æ‹Ÿå™¨ </title>
    <meta name="description" content="èµ›é©¬å¨˜ç‰ˆ">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- Tailwind (fallback utilities) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Custom Theme -->
    <link rel="stylesheet" href="assets/theme.css">

    <style>
        * {
            touch-action: manipulation;
            /* æ¶ˆé™¤ç‚¹å‡»å»¶è¿Ÿ */
            -webkit-tap-highlight-color: transparent;
        }

        /* åŸºç¡€é‡ç½®å’Œä¿éšœ */
        html,
        body {
            height: 100%;
            height: 100dvh;
            overflow: hidden !important;
            position: fixed;
            /* é˜²æ­¢æ©¡çš®ç­‹æ•ˆæœ */
            width: 100%;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Noto Sans SC', sans-serif;
            display: flex;
            flex-direction: column;
        }

        .hidden {
            display: none !important;
        }

        .page-section {
            display: none !important;
            flex-direction: column;
            width: 100%;
            height: 100%;
            max-height: 100dvh;
            overflow: hidden;
        }

        .page-section.active-screen {
            display: flex !important;
        }

        /* è€è™æœºåŠ¨ç”» */
        .scrolling {
            filter: blur(1px);
            animation: scrollText 0.08s infinite linear;
        }

        @keyframes scrollText {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-3px);
            }
        }

        .animate-bounce-once {
            animation: bounceOnce 0.5s cubic-bezier(.2, .8, .2, 1);
        }

        @keyframes bounceOnce {
            0% {
                transform: translateY(0) scale(1);
            }

            50% {
                transform: translateY(-8px) scale(1.05);
            }

            100% {
                transform: translateY(0) scale(1);
            }
        }

        /* ç¡®ä¿æ¨¡æ€å¯äº¤äº’ */
        #modal-event,
        #modal-status {
            pointer-events: auto;
            z-index: 50 !important;
        }
    </style>
</head>

<body class="theme-cute h-screen flex flex-col text-gray-800">

    <!-- ============================================ -->
    <!--              SCREEN 1: å¼€å§‹è®¾ç½®               -->
    <!-- ============================================ -->
    <div id="screen-setup"
        class="page-section active-screen flex-1 flex flex-col items-center justify-center p-4 w-full max-w-md mx-auto">
        <!-- è£…é¥°èƒŒæ™¯ -->
        <div class="floating-decoration deco-star" style="top: 10%; left: 15%;"></div>
        <div class="floating-decoration deco-star" style="top: 20%; right: 20%; animation-delay: 1s;"></div>
        <div class="floating-decoration deco-star" style="bottom: 30%; left: 10%; animation-delay: 2s;"></div>

        <div class="cute-card w-full p-6 space-y-5">
            <!-- æ ‡é¢˜ -->
            <div class="text-center">
                <h1
                    class="text-2xl font-bold bg-gradient-to-r from-primary-500 via-accent-400 to-warm-400 bg-clip-text text-transparent">
                    åŒäººå¥³è·³å‘æ¨¡æ‹Ÿå™¨
                </h1>
                <p class="text-xs text-neutral-500 mt-1">èµ›é©¬å¨˜ç‰ˆ </p>
            </div>

            <!-- CPè®¾ç½® -->
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="text-xs font-bold text-primary-600 flex items-center gap-1">
                        <span>ğŸ’•</span> æœ¬å‘½CP
                    </label>
                    <input type="text" id="inp-cp" value="AB"
                        class="w-full border-2 border-primary-200 rounded-xl p-2.5 mt-1 focus:border-primary-400 focus:outline-none transition-colors bg-white/80">
                </div>
                <div>
                    <label class="text-xs font-bold text-danger-500 flex items-center gap-1">
                        <span>ğŸ’”</span> é›·ç‚¹CP
                    </label>
                    <input type="text" id="inp-rival" value="BA"
                        class="w-full border-2 border-danger-200 rounded-xl p-2.5 mt-1 focus:border-danger-400 focus:outline-none transition-colors bg-white/80">
                </div>
            </div>

            <!-- èº«ä»½æŠ½å¡ -->
            <div class="border-t-2 border-primary-100 pt-4">
                <p class="text-xs font-bold text-primary-600 mb-3 flex items-center gap-1">
                    <span>ğŸ°</span> èº«ä»½æŠ½å¡
                </p>
                <div class="flex gap-3 mb-4">
                    <div id="slot-prefix" class="cute-slot flex-1">???</div>
                    <div id="slot-role" class="cute-slot flex-1">???</div>
                </div>
                <button onclick="Game.spinIdentity()" id="btn-spin" class="w-full cute-modal-btn py-3 text-base">
                    ğŸ² æ‘‡å·æŠ½å¡
                </button>
            </div>

            <!-- èº«ä»½æè¿° -->
            <div id="identity-desc"
                class="hidden text-xs bg-accent-50 border-2 border-accent-200 p-3 rounded-xl text-accent-700"></div>

            <!-- å¼€å§‹æŒ‰é’® -->
            <button onclick="Game.start()" id="btn-start" disabled
                class="w-full bg-neutral-300 text-neutral-500 font-bold py-3.5 rounded-xl transition-all duration-300 cursor-not-allowed">
                ğŸš€ å¼€å§‹çˆ¬å‘
            </button>
        </div>

        <!-- ç‰ˆæœ¬ä¿¡æ¯ -->
        <p class="text-xs text-neutral-400 mt-4">v2.0 </p>
    </div>

    <!-- ============================================ -->
    <!--              SCREEN 2: æ¸¸æˆä¸»ç•Œé¢             -->
    <!-- ============================================ -->
    <div id="screen-game" class="page-section flex-col h-full w-full max-w-md mx-auto relative">

        <!-- æ–°é—»æ’­æŠ¥æ¡ -->
        <div class="news-ticker">
            <div class="news-ticker-content" id="news-ticker-content">
                <span class="news-item">æ¬¢è¿æ¥åˆ°{cp}åœˆï¼ä»Šå¤©ä¹Ÿè¦åŠ æ²¹äº§ç²®å“¦~</span>
                <span class="news-item hot">çƒ­é—¨è¯é¢˜ï¼š#{cp}å¤ªç”œäº†# æ­£åœ¨çƒ­è®®ä¸­</span>
                <span class="news-item">åœˆå†…æ—¥å¸¸ï¼šåˆæœ‰å¤ªå¤ªæ›´æ–°ç¥ä»™äº§å‡ºäº†ï¼</span>
                <span class="news-item happy">å°æç¤ºï¼šè®°å¾—ä¼‘æ¯ï¼Œèº«ä½“æœ€é‡è¦~</span>
                <!-- é‡å¤ä»¥å®ç°æ— ç¼æ»šåŠ¨ -->
                <span class="news-item">æ¬¢è¿æ¥åˆ°{cp}åœˆï¼ä»Šå¤©ä¹Ÿè¦åŠ æ²¹äº§ç²®å“¦~</span>
                <span class="news-item hot">çƒ­é—¨è¯é¢˜ï¼š#{cp}å¤ªç”œäº†# æ­£åœ¨çƒ­è®®ä¸­</span>
                <span class="news-item">åœˆå†…æ—¥å¸¸ï¼šåˆæœ‰å¤ªå¤ªæ›´æ–°ç¥ä»™äº§å‡ºäº†ï¼</span>
                <span class="news-item happy">å°æç¤ºï¼šè®°å¾—ä¼‘æ¯ï¼Œèº«ä½“æœ€é‡è¦~</span>
            </div>
        </div>

        <!-- é¡¶éƒ¨çŠ¶æ€æ  -->
        <div class="cute-header p-4">
            <!-- æ—¥æœŸå’Œé˜¶æ®µ -->
            <div class="flex justify-between items-center mb-3">
                <div class="flex items-center gap-2">
                    <span class="bg-primary-100 text-primary-800 px-3 py-1 rounded-full text-sm font-medium">
                        ğŸ“… <span id="disp-date">1å¹´1æœˆ</span>
                    </span>
                    <span class="bg-warm-100 text-warm-800 px-3 py-1 rounded-full text-sm font-medium">
                        <span id="disp-phase">ğŸŒ¸ å…¥å‘æœŸ</span>
                    </span>
                </div>
                <div class="text-right">
                    <div class="text-2xl font-bold stat-value text-primary-700">
                        ğŸ§  <span id="val-san">100</span>
                    </div>
                    <div class="text-xs text-neutral-600">SANå€¼</div>
                </div>
            </div>

            <!-- å±æ€§æ¡ -->
            <div class="space-y-2">
                <div class="stat-bar-container">
                    <div class="stat-bar-label">
                        <span>ğŸ’– å¨åŠ›</span>
                        <span id="val-love">50</span>
                    </div>
                    <div class="stat-bar-track">
                        <div id="bar-love" class="stat-bar-fill love" style="width: 50%"></div>
                    </div>
                </div>
                <div class="stat-bar-container">
                    <div class="stat-bar-label">
                        <span>ğŸ¨ æŠ€æœ¯</span>
                        <span id="val-tech">10</span>
                    </div>
                    <div class="stat-bar-track">
                        <div id="bar-tech" class="stat-bar-fill tech" style="width: 10%"></div>
                    </div>
                </div>
            </div>

            <!-- çƒ­åº¦æ˜¾ç¤º -->
            <div class="flex justify-between mt-3 text-sm">
                <span class="bg-white/15 px-3 py-1 rounded-full">
                    ğŸ”¥ CPçƒ­åº¦ <span id="val-cpheat" class="font-bold">0</span>
                </span>
                <span class="bg-white/15 px-3 py-1 rounded-full">
                    â­ æˆ‘çš„çƒ­åº¦ <span id="val-myheat" class="font-bold">0</span>
                </span>
            </div>
        </div>

        <!-- ä¸»å†…å®¹åŒºåŸŸ - ä¼˜åŒ–å¸ƒå±€è®©æ—¥å¿—åŒºæœ€å¤§åŒ– -->
        <div class="flex-1 overflow-hidden p-2 flex flex-col gap-2 min-h-0">
            <!-- èµ„æºæ˜¾ç¤º - ç´§å‡‘å•è¡Œ -->
            <div class="resource-bar">
                <span class="res-item"><span class="res-icon">âš¡</span><span id="val-passion">100</span></span>
                <span class="res-item"><span class="res-icon">ğŸ”‹</span><span id="val-stamina">100</span></span>
                <span class="res-item"><span class="res-icon">ğŸ’°</span><span id="val-money">1000</span></span>
                <span class="res-item"><span class="res-icon">ğŸ‘¥</span><span id="val-social">50</span></span>
                <span class="res-item goal">ğŸ“<span id="val-works">0</span>/3</span>
            </div>

            <!-- æ—¥å¿—åŒºåŸŸ - æ ¸å¿ƒå±•ç¤ºåŒºï¼Œè‡ªåŠ¨å¡«å……å‰©ä½™ç©ºé—´ -->
            <div class="game-log flex-1 min-h-0" id="game-log">
                <div class="text-center text-neutral-400 text-sm py-4">
                    âœ¨ æ•…äº‹å¼€å§‹äº† âœ¨
                </div>
            </div>
        </div>

        <!-- è¡ŒåŠ¨æŒ‰é’®åŒº - ç´§å‡‘å›¾æ ‡å¸ƒå±€ -->
        <div class="action-bar">
            <button onclick="Game.action('work')" class="action-btn action-mini type-work" title="ç°å……/æ‰“å·¥">
                <span class="btn-icon">ğŸ¢</span>
                <span class="btn-label">æ‰“å·¥</span>
            </button>
            <button onclick="Game.action('create')" class="action-btn action-mini type-create" title="äº§ç²®/çº¦ç¨¿">
                <span class="btn-icon">ğŸ¨</span>
                <span class="btn-label">äº§ç²®</span>
            </button>
            <button onclick="Game.action('consume')" class="action-btn action-mini type-consume" title="å—‘ç³–/çˆ¬æ¥¼">
                <span class="btn-icon">ğŸ¬</span>
                <span class="btn-label">å—‘ç³–</span>
            </button>
            <button onclick="Game.action('social')" class="action-btn action-mini type-social" title="æ··åœˆ/æ‰©åˆ—">
                <span class="btn-icon">ğŸ’¬</span>
                <span class="btn-label">ç¤¾äº¤</span>
            </button>
            <button onclick="Game.action('rest')" class="action-btn action-mini type-rest" title="ä¼‘æ¯/é€€ç½‘">
                <span class="btn-icon">ğŸ›Œ</span>
                <span class="btn-label">ä¼‘æ¯</span>
            </button>
            <button onclick="UI.toggleStatus()" class="action-mini" title="æŸ¥çœ‹çŠ¶æ€">
                <span class="btn-icon">ğŸ“Š</span>
                <span class="btn-label">çŠ¶æ€</span>
            </button>
        </div>
    </div>

    <!-- ============================================ -->
    <!--              SCREEN 3: ç»“å±€ç”»é¢               -->
    <!-- ============================================ -->
    <div id="screen-end" class="page-section ending-screen">
        <div class="ending-card">
            <h2 class="ending-title" id="end-title">ç»“å±€æ ‡é¢˜</h2>
            <p class="ending-desc" id="end-desc">ç»“å±€æè¿°</p>

            <!-- é›·è¾¾å›¾ -->
            <div class="flex justify-center mb-4">
                <svg id="radar-chart" width="140" height="140" viewBox="0 0 200 200"></svg>
            </div>

            <!-- æœ€ç»ˆæ•°æ® -->
            <div class="bg-white/10 rounded-xl p-3 space-y-2 mb-4">
                <div class="flex justify-between text-white/80 text-sm border-b border-white/10 pb-1">
                    <span>ğŸ”¥ æœ€ç»ˆçƒ­åº¦</span>
                    <span id="end-stat-heat" class="font-bold text-pink-400"></span>
                </div>
                <div class="flex justify-between text-white/80 text-sm border-b border-white/10 pb-1">
                    <span>ğŸ“ äº§å‡ºä½œå“</span>
                    <span id="end-stat-works" class="font-bold text-blue-400"></span>
                </div>
                <div class="flex justify-between text-white/80 text-sm">
                    <span>ğŸ’° å­˜æ¬¾ç»“ä½™</span>
                    <span id="end-stat-money" class="font-bold text-green-400"></span>
                </div>
            </div>

            <!-- äººç”Ÿæ€»ç»“ -->
            <div id="life-summary" class="bg-white/95 rounded-xl p-3 mb-4 text-left max-h-48 overflow-y-auto text-sm">
                <!-- åŠ¨æ€ç”Ÿæˆçš„æˆå°±ã€å…³é”®æ—¶åˆ»ã€è¡ŒåŠ¨ç»Ÿè®¡ã€è¯„è¯­ -->
            </div>

            <button onclick="location.reload()" class="cute-modal-btn w-full py-3">
                ğŸ”„ å†æ¬¡å…¥å‘
            </button>
        </div>
    </div>

    <!-- ============================================ -->
    <!--                  æ¨¡æ€æ¡†                       -->
    <!-- ============================================ -->

    <!-- äº‹ä»¶æ¨¡æ€æ¡† -->
    <div id="modal-event" class="hidden fixed inset-0 cute-modal-overlay z-40 flex items-center justify-center p-4">
        <div class="cute-modal max-w-sm w-full p-6">
            <h3 id="evt-title" class="cute-modal-title">äº‹ä»¶æ ‡é¢˜</h3>
            <p id="evt-text" class="text-sm text-neutral-600 mb-4 leading-relaxed text-center"></p>
            <div id="evt-effects" class="text-sm bg-neutral-50 p-3 rounded-xl mb-4 space-y-1"></div>
            <div id="evt-actions" class="mb-2"></div>
            <button data-default="evt-ok" onclick="UI.closeModal()" class="cute-modal-btn w-full">
                ç¡®å®š
            </button>
        </div>
    </div>

    <!-- çŠ¶æ€æ¨¡æ€æ¡† -->
    <div id="modal-status" class="hidden fixed inset-0 cute-modal-overlay z-50 flex items-center justify-center p-4">
        <div class="cute-modal max-w-md w-full p-6">
            <h3 class="cute-modal-title">ğŸ“Š å½“å‰å±æ€§å€¾å‘</h3>
            <div class="flex justify-center mb-4">
                <svg id="status-radar" width="280" height="280" viewBox="0 0 200 200"></svg>
            </div>
            <div id="status-comment" class="text-sm text-neutral-600 text-center mb-4"></div>
            <button onclick="UI.closeStatusModal()" class="cute-modal-btn w-full">
                å…³é—­
            </button>
        </div>
    </div>

    <!-- ============================================ -->
    <!--                  è„šæœ¬                         -->
    <!-- ============================================ -->
    <script src="script/data.js"></script>
    <script src="script/state.js"></script>
    <script src="script/logic.js"></script>
    <script src="script/ui.js"></script>
    <script src="script/commentPools.js"></script>
    <script src="script/apps.js"></script>
    <script src="script/main.js"></script>

    <script>
        // åˆå§‹åŒ– Lucide å›¾æ ‡
        lucide.createIcons();

        // é¡µé¢åŠ è½½ä¿æŠ¤
        document.addEventListener('DOMContentLoaded', function () {
            try {
                // éšè—æ¨¡æ€æ¡†
                ['modal-event', 'modal-status'].forEach(id => {
                    const el = document.getElementById(id);
                    if (el) {
                        el.classList.add('hidden');
                        el.style.display = 'none';
                    }
                });

                // ç¡®ä¿åªæœ‰ setup å±å¹•æ¿€æ´»
                document.querySelectorAll('.page-section').forEach(el => el.classList.remove('active-screen'));
                const setup = document.getElementById('screen-setup');
                if (setup) setup.classList.add('active-screen');

            } catch (e) {
                console.warn('Init guard failed', e);
            }
        });
    </script>

</body>

</html>